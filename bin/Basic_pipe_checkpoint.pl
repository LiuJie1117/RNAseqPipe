#!/usr/bin/perl -w
=head1 #===============================================================================
#        USAGE: perl Basic_pipe_checkpoint.pl <Sample_info_file> <Check_log_file> 
#
#  DESCRIPTION: Check if basic pipeline processes have all been done
#
#  INPUT FILES: <goal_file>      : Sample_info.txt file in tmp directory
#               <Check_log_file> : Golobal log file generated by analysis pipeline
#
#        NOTES: None
#       AUTHOR: Xiaolong Zhang, zhangxiaol1@sysucc.org.cn
# ORGANIZATION: Bioinformatics Center, Sun Yat-sen University Cancer Center
#      VERSION: 1.0
#      CREATED: 09/30/2017
#     REVISION: ---
#===============================================================================
=cut
die `pod2text $0` unless @ARGV == 2;
use strict;

my $max_time = 172800; # 3 days
my $judge = "Yes";
my $goal = `wc -l $ARGV[0]`;
$goal = (split /\s+/, $goal)[0];
my $time = 0;
while (1<2){
	my $log = `wc -l $ARGV[1]`;
	$log = (split /\s+/, $log)[0];
	last if $log == $goal;
	sleep(10);
	$time += 10;
	if ($time > $max_time){
		$judge = "NO";
		last:
	}
}
`echo \"Check point: $judge\" >> $ARGV[1]`;
